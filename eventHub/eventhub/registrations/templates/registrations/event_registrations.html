{% extends "main/base.html" %}

{% block content %}
  <div class="container mt-3">
    <h2>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—á–∞—Å–Ω–∏–∫—ñ–≤ –¥–ª—è "{{ event.name }}"</h2>

    <!-- üîπ –ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ —É—á–∞—Å–Ω–∏–∫–∏ -->
    <h3>–ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ —É—á–∞—Å–Ω–∏–∫–∏</h3>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>–Ü–º'—è</th>
          <th>Email</th>
          <th>–î—ñ—è</th>
        </tr>
      </thead>
      <tbody>
        {% for user in registered_users %}
          <tr>
            <td>{{ user.full_name }}</td>
            <td>{{ user.email }}</td>
            <td>
              <form method="POST" action="{% url 'remove_registration' event.id user.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">–í–∏–¥–∞–ª–∏—Ç–∏</button>
              </form>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3">–ù–µ–º–∞—î –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- üîπ –§–æ—Ä–º–∞ –ø–æ—à—É–∫—É -->
    <h3>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–æ–≥–æ —É—á–∞—Å–Ω–∏–∫–∞</h3>
    <form method="get" class="mb-3">
      <input type="text" name="full_name" placeholder="–ü–æ—à—É–∫ –∑–∞ —ñ–º‚Äô—è–º" class="form-control" value="{{ request.GET.full_name }}">
      <input type="email" name="email" placeholder="–ü–æ—à—É–∫ –∑–∞ email" class="form-control mt-2" value="{{ request.GET.email }}">
      <select name="sort_by" class="form-select">
        <option value="">–°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞...</option>
        <option value="full_name" {% if request.GET.sort_by == "full_name" %}selected{% endif %}>–Ü–º'—è (–ê-–Ø)</option>
        <option value="-full_name" {% if request.GET.sort_by == "-full_name" %}selected{% endif %}>–Ü–º'—è (–Ø-–ê)</option>
        <option value="email" {% if request.GET.sort_by == "email" %}selected{% endif %}>Email (–ê-–Ø)</option>
        <option value="-email" {% if request.GET.sort_by == "-email" %}selected{% endif %}>Email (–Ø-–ê)</option>
      </select>
      <button type="submit" class="btn btn-primary mt-2">–ü–æ—à—É–∫</button>
    </form>

    <!-- üîπ –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è -->
    <form method="POST">
      {% csrf_token %}
      <table class="table table-striped">
        <thead>
          <tr>
            <th>–í–∏–±—Ä–∞—Ç–∏</th>
            <th>–Ü–º'—è</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
            <tr>
              <td><input type="checkbox" name="user_ids" value="{{ user.id }}"></td>
              <td>{{ user.full_name }}</td>
              <td>{{ user.email }}</td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="3">–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <button type="submit" class="btn btn-success">–î–æ–¥–∞—Ç–∏ –≤–∏–±—Ä–∞–Ω–∏—Ö</button>
    </form>
  </div>
{% endblock %}
